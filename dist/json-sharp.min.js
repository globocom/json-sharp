/*
 *  json-sharp - v0.1.0
 *  Process operations on pure JSON objects
 *
 *  Made by Globo.com
 *  Under MIT License
 */

!function(e,r){"function"==typeof define&&define.amd?define(r):"object"==typeof exports?module.exports=r():e.deepmerge=r()}(this,function(){return function e(r,t){var o=Array.isArray(t),n=o&&[]||{};return o?(r=r||[],n=n.concat(r),t.forEach(function(t,o){void 0===n[o]?n[o]=t:"object"==typeof t?n[o]=e(r[o],t):-1===r.indexOf(t)&&n.push(t)})):(r&&"object"==typeof r&&Object.keys(r).forEach(function(e){n[e]=r[e]}),Object.keys(t).forEach(function(o){"object"==typeof t[o]&&t[o]&&r[o]?n[o]=e(r[o],t[o]):n[o]=t[o]})),n}}),function(e,r){"function"==typeof define&&define.amd?define(["deepmerge","JSONPath"],r):"object"==typeof module&&module.exports?module.exports=r(require("deepmerge"),require("JSONPath")):e.returnExports=r(e.deepmerge,e.jsonPath)}(this,function(e,r){var t={process:function(e,r){var t=this._clone(e);return this.processNode(t,r)},processNode:function(e,r){var t=Object.prototype.toString.call(e),o="[object Array]"===t;return"[object Object]"===t?this.processObject(e,r):o?this.processArray(e,r):e},processObject:function(e,r){var t,o;if(void 0!==(o=this.getOperation(e)))return o.func(this.processNode(e[o.name],r),r);for(t in e)e.hasOwnProperty(t)&&(e[t]=this.processNode(e[t],r));return e},processArray:function(e,r){for(var t=0;t<e.length;t++)e[t]=this.processNode(e[t],r);return e},getOperation:function(e){for(var r in this.operations)if(this.operations.hasOwnProperty(r)&&e.hasOwnProperty(r))return{name:r,func:this.operations[r]}},resolveProperty:function(e,t){return 0!==e.indexOf("$.")?t[e]:r.eval(t,e)},operations:{"#merge":function(r){return e.apply(e,r)},"#switch":function(e,r){var o,n=t.resolveProperty(e["#property"],r),i=e["#case"];return void 0!==(o=i[n])?o:void 0!==(o=i["#default"])?o:void 0}},_clone:function(e){return JSON.parse(JSON.stringify(e))}};return{JSONSharp:t}});